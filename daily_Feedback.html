<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì˜¤ëŠ˜ì˜ í•™ìŠµ í”¼ë“œë°±</title>

    <!-- Existing Project CSS and Fonts -->
    <!-- Make sure css/styles.css exists if you're using it -->
    <link rel="stylesheet" href="css/styles.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;700&display=swap"
      rel="stylesheet"
    />

    <!-- Keep the inline styles as they are global -->
    <style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: "Pretendard", -apple-system, BlinkMacSystemFont, sans-serif;
        background-color: #fdf8f4;
        max-width: 390px; /* Target max-width */
        margin: 0 auto;
        color: #333;
        line-height: 1.6;
        min-height: 100vh; /* Ensure body fills viewport height */
        display: flex; /* Use flex to push footer down */
        flex-direction: column; /* Arrange children vertically */
    }

    /* ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ë°” */
    .header {
        position: sticky;
        top: 0;
        left: 0;
        right: 0;
        background-color: #fdf8f4;
        padding: 12px 16px; /* Reduced horizontal padding */
        border-bottom: 1px solid #e8ddd4;
        display: flex;
        justify-content: space-between;
        align-items: center;
        z-index: 1000;
    }

    .logo {
        display: flex;
        align-items: center;
        font-size: 18px;
        font-weight: 700;
        color: #f96c50;
    }

    .logo i {
        margin-right: 8px;
        font-size: 22px; /* Slightly smaller icon */
    }

    .header-actions {
        display: flex;
        gap: 12px; /* Reduced gap */
    }

    .header-btn {
        background: none;
        border: none;
        padding: 8px;
        border-radius: 8px;
        color: #DD6B20;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .header-btn:hover {
        background: #FFF3E0;
        transform: scale(1.05);
    }

    /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
    .main-container {
        margin-top: 60px; /* Adjusted margin-top */
        padding: 16px; /* Reduced padding */
        width: 100%; /* Ensure it fills the body width */
        flex-grow: 1; /* Allow main content to grow */
    }

    /* í˜ì´ì§€ íƒ€ì´í‹€ */
    .page-title {
        text-align: center;
        margin-bottom: 24px; /* Adjusted margin */
    }

    .page-title h1 {
        font-size: 24px; /* Reduced font size */
        font-weight: 700;
        color: #333;
        margin-bottom: 4px; /* Reduced margin */
    }

    .page-title p {
        font-size: 14px; /* Reduced font size */
        color: #666;
    }

    /* ì¹´ë“œ ê³µí†µ ìŠ¤íƒ€ì¼ */
    .card {
        background: white;
        border-radius: 12px; /* Slightly smaller border-radius */
        padding: 16px; /* Reduced padding */
        margin-bottom: 16px; /* Reduced margin-bottom */
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05); /* Slightly softer shadow */
        border: 1px solid #f0f0f0;
    }

    .card-title {
        font-size: 18px; /* Reduced font size */
        font-weight: 600;
        color: #333;
        margin-bottom: 12px; /* Reduced margin */
        display: flex;
        align-items: center;
    }

    .card-title i {
        margin-right: 8px;
        color: #f96c50;
        font-size: 1.1em; /* Relative size */
    }

    /* ì˜¤ëŠ˜ì˜ í•™ìŠµ ìš”ì•½ */
    .summary-stats {
        display: grid;
        /* minmax(200px, 1fr) would likely cause overflow on 390px - padding */
        /* Let grid handle it naturally, or explicitly set to 1fr on small screens */
        /* As per previous logic, the media query handles this better,
           but let's make the base definition reasonable too */
         grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); /* Adjusted minmax */
        gap: 16px; /* Reduced gap */
        margin-bottom: 16px; /* Reduced margin */
    }

    .stat-item {
        text-align: center;
        padding: 16px; /* Reduced padding */
        background: #f8f9fa;
        border-radius: 10px; /* Slightly smaller border-radius */
    }

    .stat-value {
        font-size: 24px; /* Reduced font size */
        font-weight: 700;
        color: #f96c50;
        margin-bottom: 4px;
    }

    .stat-label {
        font-size: 13px; /* Slightly smaller font size */
        color: #666;
    }

    .progress-bar {
        width: 100%;
        height: 6px; /* Reduced height */
        background: #e8ddd4;
        border-radius: 3px; /* Reduced border-radius */
        overflow: hidden;
        margin: 10px 0; /* Reduced margin */
    }

    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #f96c50, #ff8a75);
        width: 0%; /* Initial width */
        border-radius: 3px; /* Match parent */
        transition: width 0.5s ease;
    }

    .comparison-text {
        background: #e8f5e8;
        padding: 10px 12px; /* Reduced padding */
        border-radius: 6px; /* Reduced border-radius */
        color: #2d7a2d;
        font-size: 13px; /* Reduced font size */
        border-left: 3px solid #4caf50; /* Reduced border width */
        display: flex;
        align-items: center;
        gap: 6px; /* Reduced gap */
    }

    /* ì˜¤ëŠ˜ì˜ ê³µë¶€ ëª©ë¡ */
    .study-list {
        list-style: none;
    }

    .study-item {
        display: flex;
        align-items: flex-start; /* Align items to start in case text wraps */
        padding: 12px 0; /* Reduced padding */
        border-bottom: 1px solid #f0f0f0;
    }

    .study-item:last-child {
        border-bottom: none;
    }

    .study-checkbox {
        min-width: 18px; /* Reduced width */
        width: 18px; /* Reduced width */
        height: 18px; /* Reduced height */
        border: 2px solid #f96c50;
        border-radius: 4px;
        margin-right: 12px; /* Reduced margin */
        display: flex;
        align-items: center;
        justify-content: center;
        background: #f96c50;
        color: white;
        font-size: 10px; /* Reduced font size */
        flex-shrink: 0; /* Prevent shrinking */
        margin-top: 2px; /* Adjust vertical alignment */
    }

    .study-text {
        font-size: 15px; /* Slightly reduced font size */
        color: #333;
        word-break: break-word; /* Ensure long words break */
    }

    /* ì˜¤ëŠ˜ì˜ í”¼ë“œë°± */
    .feedback-card {
        background: linear-gradient(135deg, #fff5f3, #fff8f7);
        border-left: 3px solid #f96c50; /* Reduced border width */
    }

    .feedback-text {
        font-size: 15px; /* Slightly reduced font size */
        line-height: 1.7; /* Slightly adjusted line height */
        color: #444;
        padding: 12px; /* Reduced padding */
        background: rgba(255, 255, 255, 0.7);
        border-radius: 8px;
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
     .feedback-text h3 {
         font-size: 16px; /* Ensure heading inside feedback text is readable */
         margin-bottom: 4px; /* Space below heading */
         color: #E14A2E; /* Match header/logo color */
     }


    /* ìƒí˜¸ì‘ìš© ë²„íŠ¼ */
    .action-buttons {
        display: flex;
        flex-direction: column;
        gap: 12px; /* Reduced gap */
        margin-top: 24px; /* Reduced margin */
    }

    .btn-primary, .btn-secondary {
        width: 100%; /* Make buttons full width on small screens */
        padding: 14px 20px; /* Adjusted padding */
        border-radius: 10px; /* Adjusted border-radius */
        font-size: 15px; /* Adjusted font size */
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        text-decoration: none; /* Ensure buttons used as links look correct */
    }


    .btn-primary:hover {
        background: #e85a3f;
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(249, 108, 80, 0.25); /* Adjusted shadow */
    }

    .btn-secondary {
        background: linear-gradient(135deg, #ffe5e0, #fff0ed);
        color: #f96c50;
        border: 2px solid #f96c50;
    }

    .btn-secondary:hover {
        background: #f96c50;
        color: white;
        transform: translateY(-2px);
    }


    .encouragement-section {
        text-align: center;
        padding: 24px 16px; /* Reduced padding */
        background: linear-gradient(135deg, #fff8f7, #fff5f3);
        border-radius: 12px; /* Adjusted border-radius */
        margin: 24px 0; /* Reduced margin */
    }

    .encouragement-text {
        font-size: 20px; /* Reduced font size */
        font-weight: 600;
        color: #333;
        margin: 12px auto; /* Adjusted margin */
        align-items: center;
        gap: 8px;
        word-break: break-word;
    }

    .encouragement-subtitle {
        font-size: 14px; /* Reduced font size */
        color: #666;
        margin-bottom: 20px; /* Adjusted margin */
        word-break: break-word;
    }

    /* í•˜ë‹¨ í‘¸í„° */
    .footer {
        background: #faf5f1;
        padding: 24px 16px; /* Reduced padding */
        text-align: center;
        margin-top: auto; /* Push footer to the bottom */
        border-top: 1px solid #e8ddd4;
    }

    .footer-content {
        max-width: 800px; /* This is fine, limited by body */
        margin: 0 auto;
    }

    .footer-links {
        display: flex;
        flex-direction: column; /* Stack links on small screens */
        gap: 12px; /* Reduced gap */
        margin-bottom: 16px;
    }

    .footer-links a {
        color: #666;
        text-decoration: none;
        font-size: 13px; /* Reduced font size */
        transition: color 0.3s ease;
    }

    .footer-links a:hover {
        color: #f96c50;
    }

    .footer-text {
        font-size: 11px; /* Reduced font size */
        color: #999;
    }

    /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
    .modal {
        display: none; /* Controlled by JS */
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 2000;
        animation: fadeIn 0.3s ease;
    }

    .modal-content {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 24px; /* Reduced padding */
        border-radius: 12px; /* Reduced border-radius */
        max-width: 360px; /* Adjusted max-width to fit within body */
        width: calc(100% - 32px); /* Account for body padding if needed, or just use 90% */
        width: 90%; /* Ensure it's 90% of viewport width */
        animation: slideUp 0.3s ease;
    }

    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px; /* Reduced margin */
    }

    .modal-title {
        font-size: 18px; /* Reduced font size */
        font-weight: 600;
        color: #333;
    }

    .close-btn {
        background: none;
        border: none;
        font-size: 22px; /* Reduced font size */
        color: #666;
        cursor: pointer;
    }

    /* Emoji rating styling */
    #emoji-rating span {
        transition: all 0.2s;
        border-radius: 50%;
        padding: 2px 4px;
        filter: grayscale(1); /* Start with grayscale */
        opacity: 0.6; /* Start with reduced opacity */
        transform: scale(1);
    }

    #emoji-rating span:hover {
         filter: grayscale(0); /* Remove grayscale on hover */
         opacity: 1; /* Full opacity on hover */
         transform: scale(1.1); /* Slight scale on hover */
    }


    #emoji-rating span.selected {
        transform: scale(1.2); /* Slightly less scale when selected */
        filter: none; /* Remove grayscale */
        background: #fff0ed;
        opacity: 1; /* Full opacity */
    }

    #emoji-rating span.unselected {
        filter: grayscale(1);
        opacity: 0.5; /* More opacity for unselected */
        transform: scale(1);
        background: none;
    }

    /* Satisfaction textarea */
    #satisfaction-text {
        resize: vertical; /* Allow vertical resize */
        overflow: auto; /* Show scrollbar if needed */
        box-sizing: border-box;
        width: 100%; /* Make it responsive */
        /* max-width: 400px; Removed as body max-width handles this */
        margin-left: auto;
        margin-right: auto;
        margin-bottom: 12px;
        border-radius: 8px;
        border: 1px solid #e8ddd4;
        padding: 8px;
        min-height: 60px; /* Increased min-height */
        font-size: 14px; /* Consistent font size */
    }

    /* Animation Keyframes */
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    @keyframes slideUp {
        from { transform: translate(-50%, -40%); opacity: 0; }
        to { transform: translate(-50%, -50%); opacity: 1; }
    }

    /* Removed the redundant @media (max-width: 768px) block
       as styles are adjusted for 390px directly or handled by flex/grid */
    </style>

    <!-- React and Babel CDNs -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lucide@latest/dist/umd/lucide.min.js"></script>
  </head>
  <body>
    <div id="root">
      <!-- React app will be mounted here -->
    </div>

    <script type="text/babel">
    const { useState, useEffect } = React;
    const root = ReactDOM.createRoot(document.getElementById('root'));

    // Simulated API call function (from original script)
    const myfetch = function(url, options) {
      if (url === "/api/feedback/daily") {
        const feedbacks = [
          {
            "analysis": "ì˜¤ëŠ˜ ì´ì°¨í•¨ìˆ˜ ê°œë… ë³µìŠµì„ 60ë¶„ì— 100% ì™„ë£Œí•´ ê°œë… ì´í•´ê°€ íƒ„íƒ„í•´ì¡ŒìŠµë‹ˆë‹¤. ë°˜ë©´ ìŠ¤ìŠ¤ë¡œ í™•ì¸í•˜ê¸° ë¬¸ì œëŠ” 45ë¶„ì— 70% í’€ì–´ ì •í™•ë„ì™€ ì‹¤ì „ ì ìš© ì—°ìŠµì´ ë” í•„ìš”í•©ë‹ˆë‹¤.",
            "suggestion": "ë‚´ì¼ì€ ì‹¤ì œ ì‹œí—˜ì²˜ëŸ¼ 30ë¶„ ë™ì•ˆ ì´ì°¨í•¨ìˆ˜ ë¬¸ì œ 10ë¬¸ì œë¥¼ í’€ì–´ë³´ì„¸ìš”. ëª©í‘œëŠ” ìµœì†Œ 8ë¬¸ì œ ë§íˆê¸°, í‹€ë¦° ë¬¸ì œëŠ” ì˜¤ë‹µ ë…¸íŠ¸ì— í•µì‹¬ í’€ì´ ê³¼ì •ì„ 2~3ì¤„ë¡œ ì •ë¦¬í•´ë‘ë©´ íš¨ìœ¨ì ìœ¼ë¡œ ì ìˆ˜ë¥¼ ì˜¬ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
            "encouragement": "ì‘ì€ ì„±ì·¨ê°€ ëª¨ì—¬ í° ì ìˆ˜ ì°¨ì´ë¥¼ ë§Œë“­ë‹ˆë‹¤. ê¾¸ì¤€íˆ ì—°ìŠµí•˜ë©° í•œ ê±¸ìŒì”© ë‚˜ì•„ê°€ìš”!"
          },
          {
            "analysis": "ì˜¤ëŠ˜ ì´ì°¨í•¨ìˆ˜ ê°œë… ë³µìŠµì€ 100% ì™„ë²½íˆ ë§ˆì³¤ê³  60ë¶„ì„ íˆ¬ìí•´ ê¸°ì´ˆë¥¼ ë‹¤ì¡ŒìŠµë‹ˆë‹¤. ë¬¸ì œ í’€ì´(45ë¶„)ëŠ” 70% ì •í™•ë„ë¡œ, íŠ¹íˆ ê¼­ì§“ì  ì¢Œí‘œì™€ ëŒ€ì¹­ì¶• ë¬¸ì œì—ì„œ ì˜¤ë‹µì´ ìˆì—ˆìŠµë‹ˆë‹¤. ê¾¸ì¤€í•œ ë³µìŠµì€ ê°•ì ì´ì§€ë§Œ ë¬¸ì œ ì •í™•ë„ë¥¼ ë†’ì¼ ì—¬ì§€ê°€ ë³´ì…ë‹ˆë‹¤.",
            "suggestion": "ë‚´ì¼ì€ ì˜¤ëŠ˜ í‹€ë¦° 3~5ë¬¸ì œë¥¼ ê³¨ë¼ í’€ì´ ê³¼ì •ì„ í•„ê¸°í•˜ë©° ì˜¤ë‹µ ë…¸íŠ¸ë¥¼ ë§Œë“¤ê³ , ìœ ì‚¬ ë¬¸ì œ 5ê°œë¥¼ 30ë¶„ íƒ€ì´ë¨¸ë¥¼ ì¼œê³  í’€ì–´ ì¦‰ì‹œ ì±„ì  í›„ ì˜¤ë‹µ ì›ì¸ì„ ì •ë¦¬í•´ë³´ì„¸ìš”.",
            "encouragement": "ì‘ì€ ë…¸ë ¥ë“¤ì´ ëª¨ì—¬ ë†’ì€ ì ìˆ˜ë¡œ ì´ì–´ì§‘ë‹ˆë‹¤. ì˜¤ëŠ˜ë„ ì˜í–ˆì–´ìš”, ë‚´ì¼ë„ íŒŒì´íŒ…!"
          },
          {
            "analysis": "ì˜¤ëŠ˜ ì´ì°¨í•¨ìˆ˜ ë³µìŠµì—ì„œ ê°œë… ì´í•´ë¥¼ 100% ë‹¬ì„±í•´ íƒ„íƒ„í•œ ê¸°ì´ˆë¥¼ ë‹¤ì¡ŒìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì‹¤ì „ ë¬¸ì œ í’€ì´ëŠ” 70% ìˆ˜ì¤€ìœ¼ë¡œ, íŠ¹íˆ ì‘ìš© ë¬¸ì œì—ì„œ ì‹œê°„ì´ ë¶€ì¡±í•˜ê±°ë‚˜ í’€ì´ ì ˆì°¨ê°€ í—·ê°ˆë¦° ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.",
            "suggestion": "ë‚´ì¼ì€ ì‹œí—˜ ì§ì „ì²˜ëŸ¼ 30ë¶„ ì•ˆì— ì´ì°¨í•¨ìˆ˜ ë¬¸ì œ 10ë¬¸ì œë¥¼ í’€ê³ , í‹€ë¦¬ê±°ë‚˜ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦° ë¬¸ì œëŠ” ì¦‰ì‹œ ì˜¤ë‹µ ë…¸íŠ¸ì— ì •ë¦¬í•´ ë³´ì„¸ìš”.",
            "encouragement": "ì§€ê¸ˆì²˜ëŸ¼ ê¸°ì´ˆë¥¼ ë‹¤ì§€ê³  ì‹¤ì „ ì—°ìŠµì„ ëŠ˜ë¦¬ë©´ ê³§ ì ìˆ˜ í–¥ìƒì´ ëˆˆì— ë³´ì¼ ê±°ì˜ˆìš”!"
          },
          {
            "analysis": "ì˜¤ëŠ˜ ì´ì°¨í•¨ìˆ˜ í•µì‹¬ ê°œë… ë³µìŠµì„ 100% ì™„ë£Œí•˜ë©° ê·¸ë˜í”„ ê°œí˜• ì´í•´ê°€ íƒ„íƒ„í•´ì¡ŒìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ìŠ¤ìŠ¤ë¡œ í™•ì¸í•˜ê¸° ë¬¸ì œëŠ” 70%ë§Œ ë§ì¶° ì‹œí—˜ ëŒ€ë¹„ê°€ ë¶€ì¡±í•œ ë¶€ë¶„ì´ ë‚¨ì•„ ìˆìŠµë‹ˆë‹¤.",
            "suggestion": "ë‚´ì¼ì€ í‹€ë¦° ë¬¸ì œ ìœ„ì£¼ë¡œ ì˜¤ë‹µë…¸íŠ¸ë¥¼ ë§Œë“¤ì–´ í•µì‹¬ ê³µì‹ê³¼ í’€ì´ ê³¼ì •ì„ ì •ë¦¬í•œ ë’¤, 30ë¶„ ë™ì•ˆ íƒ€ì´ë¨¸ë¥¼ ì¼œê³  10ë¬¸ì œë¥¼ í’€ì–´ë³´ì„¸ìš”. ìŠ¤ìŠ¤ë¡œ ì±„ì í•´ ëª©í‘œ ë§íŒ ê°œìˆ˜ë¥¼ ê¸°ë¡í•˜ë©´ ì„±ì·¨ê°ì„ ëŠë¼ê¸° ì¢‹ìŠµë‹ˆë‹¤.",
            "encouragement": "ì§€ê¸ˆì²˜ëŸ¼ ê¾¸ì¤€íˆ í•´ë‚˜ê°€ë©´ ì ì  ì‹œí—˜ ì„±ì ì— ìì‹ ê°ì´ ìƒê¸¸ ê±°ì˜ˆìš”. í™”ì´íŒ…!"
          },
          {
            "analysis": "ì˜¤ëŠ˜ ì´ì°¨í•¨ìˆ˜ í•µì‹¬ ê°œë… ë³µìŠµì„ 100% ì™„ë£Œí•˜ë©° ê¸°ì´ˆë¥¼ íƒ„íƒ„íˆ ë‹¤ì¡ŒìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë¬¸ì œ í’€ì´ì—ì„œëŠ” 70%ì˜ ì •ë‹µë¥ ì„ ë³´ì—¬, íŠ¹íˆ ê¼­ì§“ì  ì¢Œí‘œì™€ ì´ì°¨ì‹ ë³€í˜• ë¬¸ì œì—ì„œ ì‹¤ìˆ˜ê°€ ìˆì—ˆìŠµë‹ˆë‹¤.",
            "suggestion": "ë‚´ì¼ì€ ì˜¤ë‹µ ë…¸íŠ¸ì— í‹€ë¦° ë¬¸ì œë¥¼ ìœ í˜•ë³„ë¡œ ì •ë¦¬í•œ ë’¤, ë¹„ìŠ·í•œ ë¬¸ì œ 3ê°œë¥¼ ê°ê° ì œí•œì‹œê°„ 10ë¶„ ì•ˆì— í’€ì–´ ë³´ì„¸ìš”. ì‹œí—˜ ì‹¤ì „ ê°ê°ê³¼ ë¬¸ì œ í•´ê²° ì†ë„ë¥¼ ë™ì‹œì— ë†’ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
            "encouragement": "ì‘ì€ ì„±ì·¨ë“¤ì´ ìŒ“ì´ë©´ ì ìˆ˜ê°€ í¬ê²Œ ì˜¤ë¦…ë‹ˆë‹¤. ê¾¸ì¤€íˆ í•´ ë‚˜ê°€ë©´ ì›í•˜ëŠ” ëª©í‘œì— ê¼­ ë„ë‹¬í•  ê±°ì˜ˆìš”!"
          },
        ];
        const feedback = feedbacks[Math.floor(Math.random() * feedbacks.length)];

        return Promise.resolve({
          ok: true,
          status: 200,
          json: () => Promise.resolve({
            date: (new Date()).toLocaleString("ko-KR", {
              year: "numeric",
              day: "numeric",
              month: "numeric",
              weekday: "long",
            }),
            achievement: 87,
            totalTime: 105, // in minutes
            comparisonText: "ì§€ë‚œì£¼ ì˜¤ëŠ˜ë³´ë‹¤ 15ë¶„ ë” ê³µë¶€í–ˆì–´ìš”", // Example comparison text
            studyItems: [
              "ì´ì°¨í•¨ìˆ˜ ë³µìŠµ: í•µì‹¬ ê°œë… ë° ax^2 ê·¸ë˜í”„ ê°œí˜•(pp.118-129)",
              "ì´ì°¨í•¨ìˆ˜ ë¬¸ì œ: ìŠ¤ìŠ¤ë¡œ í™•ì¸í•˜ê¸° í’€ê¸°(p.121, p.128, p.133)",
            ],
            feedback: feedback,
          })
        });
      }

      return Promise.resolve({
        ok: false,
        status: 404,
        json: () => Promise.resolve({ error: "Not found" })
      });
    };

    // Component for the Header
    const Header = () => (
      <header className="header">
        <div className="logo">
          <i className="fas fa-graduation-cap"></i>
          MyStudy
        </div>
        <div className="header-actions">
          <button
            onClick={(e) => {e.stopPropagation(); window.location.href = 'study_planner_home_(ver. REACT).html';}}
            className="header-btn"
          >
            <i data-lucide="home" className="lucide" style={{ width: 20, height: 20 }} />
          </button>
          <button
            onClick={() => window.location.reload() }
            className="header-btn"
          >
            <i data-lucide="refresh-cw" className="lucide" style={{ width: 20, height: 20 }} />
          </button>
        </div>
      </header>
    );

    // Component for the Footer
    const Footer = () => (
      <footer className="footer">
        <div className="footer-content">
          <div className="footer-links">
            <a href="#team">íŒ€ ì†Œê°œ</a>
            <a href="#contact">ë¬¸ì˜í•˜ê¸°</a>
            <a href="#privacy">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
            <a href="#terms">ì´ìš©ì•½ê´€</a>
          </div>
          <div className="footer-text">Â© 2024 HCI Team 6. All rights reserved.</div>
        </div>
      </footer>
    );

    // Component for the Satisfaction Section
    const SatisfactionSection = () => {
      const [rating, setRating] = useState(0);
      const [satisfactionText, setSatisfactionText] = useState("");
      const [showInput, setShowInput] = useState(false);
      const [resultMessage, setResultMessage] = useState("");

      const emojiLabels = [
        "ë§¤ìš° ë¶ˆë§Œì¡±",
        "ë¶ˆë§Œì¡±",
        "ë³´í†µ",
        "ë§Œì¡±",
        "ë§¤ìš° ë§Œì¡±",
      ];
      const emojis = ["ğŸ˜¡", "ğŸ˜•", "ğŸ˜", "ğŸ™‚", "ğŸ˜"];

      const handleEmojiClick = (value) => {
        setRating(value);
        setShowInput(true);
        setResultMessage(""); // Clear previous result message
      };

      const handleSubmit = () => {
        if (!rating) {
          setResultMessage("ë§Œì¡±ë„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!");
          return;
        }

        const today = new Date();
        const y = today.getFullYear();
        const m = String(today.getMonth() + 1).padStart(2, "0");
        const d = String(today.getDate()).padStart(2, "0");
        const dateStr = `${y}ë…„${m}ì›”${d}ì¼ ê³„íš ìƒì„±ì— ëŒ€í•œ í”¼ë“œë°±`;

        const feedback = {
          date: dateStr,
          rating: rating,
          text: satisfactionText.trim(),
        };

        // Save to localStorage
        let arr = JSON.parse(localStorage.getItem("planSatisfaction") || "[]");
        arr.push(feedback);
        localStorage.setItem("planSatisfaction", JSON.stringify(arr));

        setResultMessage("í”¼ë“œë°±ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤!");
        setRating(0); // Reset rating
        setSatisfactionText(""); // Clear text
        setShowInput(false); // Hide input
        setTimeout(() => {
          setResultMessage(""); // Clear message after a delay
        }, 2500);
      };

      return (
        <div
          className="card"
          style={{ textAlign: "center", marginBottom: "32px" }}
        >
          <h3 style={{ marginBottom: "12px" }}>ì˜¤ëŠ˜ ê³„íš ìƒì„±ì— ëŒ€í•œ ë§Œì¡±ë„!</h3>
          <div
            id="emoji-rating"
            style={{
              fontSize: "2rem",
              display: "flex",
              justifyContent: "center",
              gap: "16px",
              marginBottom: "12px",
            }}
          >
            {emojis.map((emoji, index) => (
              <span
                key={index}
                data-value={index + 1}
                title={emojiLabels[index]}
                style={{ cursor: "pointer" }}
                onClick={() => handleEmojiClick(index + 1)}
                className={
                  rating === 0 ? "" : rating === index + 1 ? "selected" : "unselected"
                }
              >
                {emoji}
              </span>
            ))}
          </div>
          {rating > 0 && (
            <div id="selected-rating" style={{ marginBottom: "12px", color: "#f96c50", fontWeight: "600" }}>
              {emojiLabels[rating - 1]} {emojis[rating - 1]}
            </div>
          )}

          {showInput && (
            <>
              <textarea
                id="satisfaction-text"
                rows="2"
                placeholder="ì˜¤ëŠ˜ ê³„íšì— ëŒ€í•´ í•œì¤„í‰ì„ ë‚¨ê²¨ì£¼ì„¸ìš”!"
                value={satisfactionText}
                onChange={(e) => setSatisfactionText(e.target.value)}
                style={{ display: showInput ? "block" : "none" }} // Control display via style
              ></textarea>
              <button
                id="satisfaction-submit"
                className="btn-secondary"
                style={{ display: showInput ? "inline-block" : "none", align: "center" }} // Control display
                onClick={handleSubmit}
              >
                ì œì¶œí•˜ê¸°
              </button>
            </>
          )}
          {resultMessage && (
            <div
              id="satisfaction-result"
              style={{
                marginTop: "10px",
                color: resultMessage.includes("ê°ì‚¬í•©ë‹ˆë‹¤") ? "#2D7A2D" : "#F96C50",
                fontWeight: "500"
              }}
            >
              {resultMessage}
            </div>
          )}
        </div>
      );
    };

    // Component for the Encouragement Section
    const EncouragementSection = ({ encouragementText }) => {
      const [buttonText, setButtonText] = useState("ë‚´ì¼ë„ í™”ì´íŒ…! ğŸ’ª");
      const [buttonStyle, setButtonStyle] = useState({}); // Use state for dynamic style

      const handleEncourageClick = () => {
        setButtonText('ì‘ì›í•´ì£¼ì…”ì„œ ê°ì‚¬í•´ìš”! â¤ï¸');
        setButtonStyle({
          background: '#F96C50',
          color: 'white',
          border: '2px solid #F96C50'
        });

        setTimeout(() => {
          setButtonText("ë‚´ì¼ë„ í™”ì´íŒ…! ğŸ’ª");
          setButtonStyle({
            background: 'linear-gradient(135deg, #FFE5E0, #FFF0ED)',
            color: '#F96C50',
            border: '2px solid #F96C50'
          });
        }, 2000);
      };

      return (
        <div className="encouragement-section">
          <div className="encouragement-text">ì˜¤ëŠ˜ í•˜ë£¨ë„ ìˆ˜ê³ í–ˆì–´ìš”! ğŸ‰</div>
          <div className="encouragement-subtitle">{encouragementText}</div>
          <button
            id="encourage-btn"
            className="btn-secondary"
            onClick={handleEncourageClick}
            style={buttonStyle} // Apply dynamic style
          >
            {buttonText}
          </button>
        </div>
      );
    };

    // Main App Component
    function DailyFeedback() {
      const [feedbackData, setFeedbackData] = useState(null);
      const [loading, setLoading] = useState(true);

      useEffect(() => {
        // Fetch main data
        myfetch("/api/feedback/daily")
          .then((response) => response.json())
          .then((data) => {
            setFeedbackData(data);
          })
          .catch((err) => {
            console.error("Failed to fetch feedback data:", err);
            // Set empty state or error state if needed
            setFeedbackData({});
          })
          .finally(() => {
            setLoading(false);
          });
      }, []); // Empty dependency array means this effect runs once on mount

      useEffect(() => {
        if (!loading) {
          lucide.createIcons();
        }
      }, [loading]);

      if (loading) {
        return (
          <>
            <Header />
            <div className="main-container">
              <div style={{textAlign: 'center', marginTop: '50px'}}>ë¡œë”© ì¤‘...</div>
            </div>
            <Footer />
          </>
        ); // Or a proper loading spinner
      }

      const encouragementSubtitle = feedbackData ?
        feedbackData.feedback.encouragement
        : 'ë°ì´í„° ë¡œë”©ì— ì‹¤íŒ¨í–ˆì–´ìš”.';

      return (
        <>
          <Header />
          <div className="main-container">
            <div className="page-title">
              <h1>ì˜¤ëŠ˜ì˜ í•™ìŠµ í”¼ë“œë°± ğŸ“…</h1>
              <p>{feedbackData?.date || "â€” â€” â€” â€” â€” í•™ìŠµ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”"}</p>
            </div>

            <div className="card">
              <h2 className="card-title">
                <i className="fas fa-chart-line"></i>
                í•™ìŠµ ìš”ì•½
              </h2>

              <div className="summary-stats">
                <div className="stat-item">
                  <div className="stat-value">{feedbackData?.achievement != null ? feedbackData.achievement + "%" : "--%"}</div>
                  <div className="stat-label">ëª©í‘œ ë‹¬ì„±ë¥ </div>
                  <div className="progress-bar">
                    <div className="progress-fill" style={{ width: `${feedbackData?.achievement || 0}%` }}></div>
                  </div>
                </div>
                <div className="stat-item">
                  <div className="stat-value">
                    {feedbackData?.totalTime != null ? `${Math.floor(feedbackData.totalTime / 60)}ì‹œê°„ ${(feedbackData.totalTime % 60)}ë¶„` : "--ì‹œê°„ --ë¶„"}
                  </div>
                  <div className="stat-label">ì´ í•™ìŠµ ì‹œê°„</div>
                </div>
              </div>

              {feedbackData?.comparisonText && (
                <div className="comparison-text">
                  <i className="fas fa-arrow-up"></i>
                  {feedbackData.comparisonText}
                </div>
              )}
              {!feedbackData?.comparisonText && (
                <div className="comparison-text" style={{display: 'none'}}></div>
              )}
            </div>

            <div className="card">
              <h2 className="card-title">
                <i className="fas fa-book"></i>
                í•™ìŠµ ê¸°ë¡
              </h2>

              <ul className="study-list">
                {feedbackData?.studyItems?.length > 0 ? (
                  feedbackData.studyItems.map((item, index) => (
                    <li key={index} className="study-item">
                      <span className="study-checkbox"><i className="fas fa-check"></i></span>
                      <span className="study-text">{item}</span>
                    </li>
                  ))
                ) : (
                    <li className="study-item"><span className="study-text">í•™ìŠµ ëª©ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</span></li>
                  )}
              </ul>
            </div>

            <div className="card feedback-card">
              <h2 className="card-title">
                <i className="fas fa-comment-dots"></i>
                í”¼ë“œë°±
              </h2>

              <div className="feedback-text">
                {feedbackData?.feedback ? 
                  <>
                    <h3>ğŸ” í•™ìŠµ ë¶„ì„</h3>{feedbackData.feedback.analysis}<h3>ğŸ’¬ ì œì•ˆ</h3>{feedbackData.feedback.suggestion}
                  </> : (
                    "í”¼ë“œë°±ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."
                  )}
              </div>
            </div>

            <SatisfactionSection />

            <EncouragementSection encouragementText={encouragementSubtitle} />

          </div>
          <Footer />
        </>
      );
    };

    root.render(<DailyFeedback />);
    </script>
  </body>
</html>
